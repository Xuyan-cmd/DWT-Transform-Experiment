# 实验二 DWT变换域图像信息隐藏实验



## 实验目的

- 成功实现DWT变换域图像信息隐藏
- 隐藏后的图像进行多组性能测试
- 统计相关性能指标参数数据，分析影响实验的相关因素
- 分析算法的不足，提出相关改进方案和性能验证

## 实验环境

- MatlabR2021a
- Windows11

## 实验图像

- 多幅实验图像

## 实验内容

1. 

## 实验步骤

### 1、读取测试图像，并对图像进行DWT变换实现图片的信息隐藏

#### 1.1通过Matlab自带的`imread函数`读取实验所用的载体图像和隐藏信息图像

```matlab
file_name='数字图像.bmp';%载体图像
cover_object=double(imread(file_name));
figure(1)
imshow(cover_object,[])
title('原始图像')

mc=size(cover_object,1);
nc=size(cover_object,2);
file_name='隐藏信息.bmp';%隐藏的信息图像
message=double(imread(file_name));
```

#### 1.2对原始图像实施小波变换，并实现隐藏图像的嵌入

##### 1.2.1实验原理

小波变换在图像处理中的基本思想是把图像进行多分辨率分解，生成不同空间和独立频带的子图像，然后对子图像的系数进行处理。图像是二维信号，需要在行和列上分别进行一维小波变换阁。图像经过一次小波变换后，被分解成下一级4个子带。

小波图像的各个子带分别对应了原图像在不同尺度和不同分辨率下的细节。最低频子带 LL2是原图像的逼近，原 图像的主要内容都体现在这个子带的数据中。小波图像的各个高频子带是原图像中边缘 、轮廓和纹理等细节信息的体现 ，并且各个子带所表示 的边缘 、轮廓等信息的方向是 不同的，其中HL子带表示垂直方向，LH子带表示水平方向，而对角方向则集中体现在HH子带中 。 

##### 1.2.2水印的嵌入

设原始图像为：

<img src="img/嵌入公式1.png" alt="嵌入公式1" style="zoom:50%;" />

二值水印图像为:

<img src="img/嵌入公式2.png" alt="嵌入公式2" style="zoom:50%;" />

则数字水印的嵌入过程如图:

<img src="img/嵌入公式3.png" alt="嵌入公式3" style="zoom:50%;" />

1.水印的随机置乱与降维 。为了消除二值水印图像的象素空间相关性 ,提高数字水印算法的鲁棒性 ，确保图像某一部分受到破坏后仍能全部或部分的恢复水 印，首先应对二值水印图像进行置乱变换 。将置乱后的水印图像利用行扫描形成一维向量 ，并依次标号为 l~PxQ，从而得到由原二值水印图像转换而来的一维数字水印序列。

​															<img src="img/嵌入公式4.png" alt="嵌入公式4" style="zoom:50%;" />

2.离散小波变换 。对原始图像实施L级小波变换 ，得到一 个逼近子图(最低频子带)和 3三个细节子图(高频子带)。小波变换级数的确定取决于原始图像的大小和待嵌入数字水印信息的长度 ，小波变换级数越大 ，嵌入水印的隐藏效果就越好。

3.选取纹理子块。将小波图像的高频子带划分成大小为 2x2的图像Bk子块 。计算每一个图像子块Bk的熵值和方 差。熵值较小的图像子块应 该是平滑块 ，而熵值比较大的图像子块是纹理块或边缘块 。纹理子块对应的方差较 小，边缘子块对应的方差比较大 。选取合适的熵阈值和方差阈值，便可以得到纹理子块 **Uk**（k=1，2，…,pxQ)。

4.水印嵌入。修改所选择的纹理子块内的小波系数的值G，以完成数字水印的嵌入 。其嵌入公式为：

<img src="img/嵌入公式5.png" alt="嵌入公式5" style="zoom:50%;" />

式中 ：Ck—— 纹理子块内的原小波系数值Vk —— 一维数字水印序 列V的第k个分量 ，Ck嵌入水印后纹理子块内的新小波系数值，数字水印嵌入的固定深度 。 将修改过的高频子带结合最 低频子带进行小波逆变换 ，得到嵌入 有数字水印的含水印图像。

```matlab
figure(2)
imshow(message,[])
title('隐藏信息')
mm=size(message,1);
nm=size(message,2);
[ca,ch,cv,cd]=dwt2(cover_object,'haar');
ca1=ca;
% m=moviein(30);
qiangdu=1;
% for qiangdu=1:30
for i=1:nm
    for j=1:nm
        if(message(i,j)==0)
            ca1(i,j)=ca(i,j)+qiangdu;
        end
    end
end
watermarked_image=idwt2(ca1,ch,cv,cd,'haar');
watermarked_image_round=round(watermarked_image);
watermarked_image_uint8=uint8(watermarked_image_round);
```

得到的效果图如下：

<img src="img/水印嵌入效果图.jpg" alt="水印嵌入效果图" style="zoom: 45%;" />

通过直观视觉可以看到，DWT变换在将隐藏信息图片嵌入载体图片后，图片质量和呈现效果从肉眼角度几乎没有任何变化，能够较好的达到图像信息隐藏的目标。

### 2、对嵌入水印后的图片进行水印提取，并分析前后图片变化